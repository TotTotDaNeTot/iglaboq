{% extends "admin/base.html" %}

{% block content %}
<div class="container-fluid">
    <h2 class="mt-4">Order Details #{{ order.id }}</h2>
    
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-body" style="padding-bottom: 67px;"> <!-- Увеличено пространство внизу -->
                    <h5 class="card-title">Order #{{ order.id }}</h5>
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Customer Info:</h6>
                            <p><strong>Name:</strong> {{ order.fullname }}</p>
                            <p><strong>Telegram:</strong> @{{ order.tg_username or 'Не указан' }}</p>
                            <p><strong>Phone:</strong> {{ order.phone }}</p>
                            <p><strong>Email:</strong> {{ order.email }}</p>
                        </div>
                        <div class="col-md-6">
                            <h6>Shipping Info:</h6>
                            <p><strong>City:</strong> {{ order.city }}</p>
                            <p><strong>Postcode:</strong> {{ order.postcode }}</p>
                            <h6 class="mt-3">Order Info:</h6>
                            <p><strong>Product ID:</strong> {{ order.product_id }}</p>
                            <p><strong>Quantity:</strong> {{ order.quantity }}</p> 
                            <p><strong>Amount:</strong> {{ "%.2f"|format(order.amount) }} {{ order.currency }}</p>
                            <p><strong>Payment ID:</strong> {{ order.payment_id }}</p>
                            <p><strong>Tracking Number:</strong> 
                                {% if order.track_number %}
                                    {{ order.track_number }}
                                {% else %}
                                    Not shipped yet
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Order Summary</h5>
                    <dl class="row">
                        <dt class="col-sm-4">Total Items:</dt>
                        <dd class="col-sm-8">{{ order.quantity }}</dd>
                        
                        <dt class="col-sm-4">Unit Price:</dt>
                        <dd class="col-sm-8">{{ "%.2f"|format(order.amount / order.quantity) }} {{ order.currency }}</dd>
                        
                        <dt class="col-sm-4">Total Amount:</dt>
                        <dd class="col-sm-8">{{ "%.2f"|format(order.amount) }} {{ order.currency }}</dd>
                    </dl>
                </div>
            </div>
            
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="card-title">Delivery details</h5>
                    <dl class="row">
                        <dt class="col-sm-4">Full name:</dt>
                        <dd class="col-sm-8">{{ order.fullname }}</dd>
                        
                        <dt class="col-sm-4">Phone:</dt>
                        <dd class="col-sm-8">{{ order.phone }}</dd>
                        
                        <dt class="col-sm-4">City:</dt>
                        <dd class="col-sm-8">{{ order.city }}</dd>
                        
                        <dt class="col-sm-4">Postcode:</dt>
                        <dd class="col-sm-8">{{ order.postcode }}</dd>
                        
                        <dt class="col-sm-4">Tracking Number:</dt>
                        <dd class="col-sm-8">
                            {% if order.track_number %}
                                {{ order.track_number }}
                            {% else %}
                                Not shipped yet
                            {% endif %}
                        </dd>
                    </dl>
                    
                    <div class="d-grid gap-2 mt-3">
                        {% if order.status == 'paid' %}
                        <a href="{{ url_for('orders.update_delivery_info', order_id=order.id) }}" 
                           class="btn btn-warning btn-sm">
                           Edit Delivery Info
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="d-flex justify-content-between">
                <a href="{{ url_for('orders.orders_list', status=order.status) }}" class="btn btn-secondary">
                    <i class="bi bi-arrow-left"></i> Back to Orders
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}